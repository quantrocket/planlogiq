<%@ MasterClass="Application.layouts.MainLayout" Title="planlogIQ" %>

<com:TContent ID="HeaderJavascript">

var notIsGuest = <%=!$this->User->isGuest?'true':'false'%>;
var IsAdministrator = <%=$this->User->isAdmin?'true':'false'%>;

function initDHTMLXTabbars(TabbarObject){

    if(notIsGuest){
        TabbarObject.addTab("a1","Aktivit√§ten",150);
        TabbarObject.setContent("a1", "tabhtml_1");

        TabbarObject.addTab("a2","Termine",150);
        TabbarObject.setContent("a2", "tabhtml_2");
        
    }else{
        TabbarObject.addTab("a1","Planlogiq",150);
        TabbarObject.setContent("a1", "tabhtml_1");
    }
    if(IsAdministrator){
        TabbarObject.addTab("a3","Benutzerlogging",150);
        TabbarObject.setContent("a3", "tabhtml_3");
    }
    
    TabbarObject.setTabActive("a1");
}

    function initScheduler(){
        scheduler.config.xml_date="%Y-%m-%d %H:%i";
        scheduler.config.prevent_cache = true;

        scheduler.form_blocks["my_editor"]={
                render:function(sns){
                        return "<div class='dhx_cal_ltext' style='height:100px;'>Text&nbsp;<input type='text'><br/>Details&nbsp;<input type='text'><br/>Activity&nbsp;<input type='text'></div>";
                },
                set_value:function(node,value,ev){
                        node.childNodes[1].value=value||"";
                        node.childNodes[4].value=ev.ter_descr||"";
                        node.childNodes[7].value=ev.idtm_activity||"";
                },
                get_value:function(node,ev){
                        ev.idtm_activity = node.childNodes[7].value;
                        ev.ter_descr = node.childNodes[4].value;
                        return node.childNodes[1].value;
                },
                focus:function(node){
                        var a=node.childNodes[1]; a.select(); a.focus();
                }
        }
        scheduler.config.lightbox.sections=[
            {name:"description", height:200, map_to:"text", type:"my_editor" , focus:true},
            {name:"time", height:72, type:"time", map_to:"auto"}
        ];

        scheduler.config.first_hour=6;
        scheduler.locale.labels.section_location="Location";
        
        scheduler.init('scheduler_here',new Date(),"month");
        scheduler.setLoadMode("month");
        scheduler.load('<%=$this->getRequest()->constructUrl('page','termin.TerminConnector')%>');

        var dp = new dataProcessor('<%=$this->getRequest()->constructUrl('page','termin.TerminConnector')%>');
        dp.init(scheduler);
    }

</com:TContent>


<com:TContent ID="Navigation">


</com:TContent>

<com:TContent ID="Main">

    <div id="tabhtml_1" style="overflow:auto;height:100%;background:#EBEEFA">
        <div style="overflow:hidden">

    <table width="100%" border="0">
     <tr><td valign="top">

        <com:Application.pages.container.AufgabenContainerOrganisation ID="AufgabenContainerOrganisation"/>
        <com:TActiveTextBox id="Tedauf_tabelle" Text="tm_none" visible="false" />
        <com:TActiveTextBox id="Tedauf_id" Text="0" visible="false" />
        <com:TActiveTextBox id="Tedauf_user_id" Text="0" visible="false" />

         </td>
</tr></table>
        </div>
    </div>
    <div id="tabhtml_2" style="overflow:auto;height:100%;width:100%;">
        <div id="scheduler_here" class="dhx_cal_container" style='width:100%; height:100%;'>
                <div class="dhx_cal_navline">
			<div class="dhx_cal_prev_button">&nbsp;</div>
			<div class="dhx_cal_next_button">&nbsp;</div>
			<div class="dhx_cal_today_button"></div>
			<div class="dhx_cal_date"></div>
			<div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div>
			<div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div>
			<div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div>
		</div>
		<div class="dhx_cal_header">
		</div>
		<div class="dhx_cal_data">
		</div>
        </div>

<script type="text/javascript">
    initScheduler();
</script>

    </div>
    <div id="tabhtml_3" style="overflow:auto;height:100%">
        <div style="overflow:hidden">

        <com:TActiveDataGrid
            Id="UserLogging"
            OnPageIndexChanged="pageUserLoggingListeChanged"
            AutoGenerateColumns="true"
            PageSize="15"
            AllowPaging="true"
            PagerStyle.Mode="Numeric"
            PagerStyle.HorizontalAlign="Left"
            PagerStyle.CssClass="pager"
            AlternatingItemStyle.CssClass="alternating"
            CssClass="datagrid"/>

      </div>
    </div>

</com:TContent>

<com:TContent ID="GuestMain">

    <div id="tabhtml_1" style="overflow:auto;height:100%">
        <div style="overflow:hidden">
    <com:TActivePanel Visible=<%= $this->User->isGuest %>>

<com:TImage ImageUrl="/rliq/themes/<%=$this->User->getUserTheme($this->User->getUserId(),'mod_theme')%>/gfx/splashscreen.jpg" width="100%" />

    </com:TActivePanel>
</div></div>

</com:TContent>
