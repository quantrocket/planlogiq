<%@ MasterClass="Application.layouts.MainLayout" Title="planlogIQ - Protokoll" %>

<com:TContent ID="HeaderJavascript">

function initDHTMLXTabbars(TabbarObject){
    TabbarObject.addTab("a1","Protokolle",150);
    TabbarObject.setContent("a1", "tabhtml_1");

    TabbarObject.addTab("a2","Protokollpunkte",150);
    TabbarObject.setContent("a2", "tabhtml_2");

    TabbarObject.setTabActive("a1");
}

</com:TContent>


<com:TContent ID="Navigation">

<com:Application.portlets.protokollportlet Visible="true" />

</com:TContent>
 
<com:TContent ID="Main">

<com:TClientScript PradoScripts="prado" />
<com:TClientScript PradoScripts="ajax" />
<com:TClientScript PradoScripts="effects" />

<com:TClientScriptLoader PackagePath="Application.app_code.accordion.js" PackageScripts="accordion" />

<div id="tabhtml_1" style="overflow:auto;height:100%">
        <div style="overflow:hidden">
            
<table width="100%">

<tr><td id="infoboxsmall" colspan="3">
Auf welchen Termin bezieht sich das Protokoll?
</td></tr>
<tr>
<td colspan="3">
    <com:TActiveDataGrid ID="edActListe"
                         AllowPaging="true"
                         AllowSorting="false"
                         AllowCustomPaging="true"
                         PageSize="5"
                         OnPageIndexChanged="eddtgList_PageIndexChanged"
                         OnEditCommand="edcmd_chooseActivity"
                         OnUpdateCommand="dtgList_UpdateCommand"
                         OnCancelCommand="dtgList_CancelCommand"
                         AutoGenerateColumns="false"
                         CssClass="datagrid"
                         PagerStyle.CssClass="pager"
                         AlternatingItemStyle.CssClass="alternating">
        <com:TActiveBoundColumn ID="edlst_idtm_termin" DataField="idtm_termin" HeaderText="ID" SortExpression="idtm_termin" HeaderStyle.Width="40px" />
        <com:TActiveBoundColumn ID="edlst_ter_startdate" DataField="ter_startdate" HeaderText="Datum" HeaderStyle.Width="100px" />
        <com:TActiveBoundColumn ID="edlst_ter_betreff" DataField="ter_betreff" HeaderText="Name" />
        <com:TActiveBoundColumn ID="edlst_ter_ort" DataField="ter_ort" HeaderText="Ort" />
        <com:TActiveEditCommandColumn HeaderText="SELECT" HeaderStyle.Width="100px" UpdateText="Save" EditText="Select" CancelText="Cancel"/>
    </com:TActiveDataGrid>
</td>
</tr>

<tr><td colspan="3" class="mytoolbar">
	<com:TButton Text="Save" OnClick="editButtonClicked" CssClass="windowcontent-button"/>
	<com:TButton Text="Delete" OnClick="deleteButtonClicked" CssClass="windowcontent-button"/>
        Typ: <com:TActiveDropDownList Id="edidta_protokoll_type" />
        <com:TActiveTextBox id="edidtm_protokoll" />
</td></tr>
        
<tr>
<td>Bezeichnung:</td>
<td colspan="2">
<com:TActiveTextBox Id="edprt_name" CssClass="inputlarge"/>
Datum: <com:TActiveDatePicker Id="edprt_cdate" Mode="ImageButton" DateFormat="yyyy-MM-dd" InputMode="DropDownList" />
</td>
</tr>

<tr>
<td>Ort:</td>
<td colspan="2"><com:TActiveTextBox Id="edprt_location" CssClass="inputlarge" />
Moderator:<com:TActiveDropDownList Id="edidtm_organisation" /></td>
</td>
</tr>

<tr><td id="infoboxsmall" colspan="3">
Ausgewählt: <b><com:TActiveTextBox Id="edidtm_termin" CssClass="inputsmall"/></b><com:TActiveLabel Id="edidtm_termin_label" /> - Eingeladene Teilnehmer:
</td></tr>

<tr>
<td colspan="3">
<com:TActiveDataGrid ID="edTerminParticipant"
                     AllowPaging="false"
                     AllowSorting="false"
                     AllowCustomPaging="true"
                     PageSize="20"
                     onSortCommand="dtgList_SortCommand"
                     OnPageIndexChanged="eddtgList_PageIndexChanged"
                     OnEditCommand="edcmd_chooseActivity"
                     OnUpdateCommand="addInvitedParticipant"
                     OnCancelCommand="dtgList_CancelCommand"
                     AutoGenerateColumns="false"
                     CssClass="datagrid"
                     PagerStyle.CssClass="pager"
                     AlternatingItemStyle.CssClass="alternating">
<com:TActiveButtonColumn ID="viewDetail" ButtonType="ImageButton" ImageUrl="/rliq/themes/basic/gfx/16x16/actions/view_bottom.png" CommandName="update" HeaderText="add" HeaderStyle.Width="30px" />
<com:TActiveBoundColumn ID="edlstpart_idtm_termin_organisation" DataField="idtm_termin_organisation" HeaderText="ID" SortExpression="idtm_termin_organisation" />
<com:TActiveBoundColumn ID="edlstpart_org_name" DataField="org_name" HeaderText="Name" />
<com:TActiveBoundColumn ID="edlstpart_user_role_name" DataField="user_role_name" HeaderText="Rolle" />
<com:TActiveBoundColumn ID="edlstpart_idtm_organisation" DataField="idtm_organisation" HeaderText="OrgID" />
</com:TActiveDataGrid>
</td>
</tr>

<!-- Hier startet die Auswahl der Teilnehmer -->

<tr><td colspan="3" class="portlet-title">Teilnehmer</td></tr>

<tr><td colspan="3" class="mytoolbar">
|<com:TActiveImageButton ImageUrl="/rliq/themes/basic/gfx/16x16/actions/filenew.png" OnCallback="PPNewButtonClicked"/><com:TActiveButton Text="new" onCallback="PPNewButtonClicked" CssClass="windowcontent-button"/>
|<com:TActiveImageButton ImageUrl="/rliq/themes/basic/gfx/16x16/actions/edit_add.png" OnCallback="PPSavedButtonClicked"/><com:TActiveButton Text="add/save" onCallback="PPSavedButtonClicked" CssClass="windowcontent-button"/>
|<com:TActiveImageButton ImageUrl="/rliq/themes/basic/gfx/16x16/actions/editdelete.png" OnCallback="PPDeleteButtonClicked"/><com:TActiveButton Text="delete" onCallback="PPDeleteButtonClicked" CssClass="windowcontent-button"/>
<com:TActiveTextBox id="activity_termin_edit_status" Text="0" CssClass="hiddeninput" visible="false" />
<com:TActiveTextBox id="idtm_activity_participant" CssClass="hiddeninput" visible="false" />
</td></tr>

<tr>
<td colspan="2">Verteiler/Anwesenheit:<com:TActiveDropDownList Id="edttidtm_organisation" /> / <com:TActiveCheckBox ID="act_part_anwesend" /></td>
<td id="infoboxsmall">
Teilnehmer auswählen und durch PLUS hinzufügen?
</td>
</tr>

<tr>
<td>Notizen:</td>
<td><com:TActiveTextBox Id="act_part_notiz" TextMode="MultiLine" /></td>
<td id="infoboxsmall">
Notizen und Informationen zum Teilnehmer, Grund für Abwesenheit, verspätete Anwesenheit
</td>
</tr>


<tr><td colspan="3">
<com:TActiveDataGrid ID="ParticipantListe" AllowPaging="true" AllowSorting="false" PageSize="5" onSortCommand="dtgList_SortCommand"  OnPageIndexChanged="edparticipant_PageIndexChanged" OnEditCommand="load_participant" OnUpdateCommand="dtgList_UpdateCommand" OnCancelCommand="dtgList_CancelCommand" AutoGenerateColumns="false" CssClass="datagrid" PagerStyle.CssClass="pager" AlternatingItemStyle.CssClass="alternating">
<com:TActiveBoundColumn ID="lstpart_idtm_activity_participant" DataField="idtm_activity_participant" HeaderText="ID" SortExpression="idtm_activity_participant" />
<com:TActiveBoundColumn ID="lstpart_idtm_organisation" DataField="idtm_organisation" HeaderText="Org ID" />
<com:TActiveBoundColumn ID="lstpart_org_name" DataField="org_name" HeaderText="Name" />
<com:TActiveBoundColumn ID="lstpart_user_role_name" DataField="user_role_name" HeaderText="Rolle" />
<com:TActiveBoundColumn ID="lstpart_act_anwesend" DataField="act_part_anwesend" HeaderText="Anwesend" />
<com:TActiveEditCommandColumn HeaderText="SELECT" HeaderStyle.Width="100px" UpdateText="Save" EditText="select" CancelText="Cancel"/>
</com:TActiveDataGrid>
</td></tr>

<!-- Hier endet die Auswahl der Teilnehmer -->

</table>

</div></div>

<div id="tabhtml_2" style="overflow:auto;height:100%">
        <div style="overflow:hidden">
<table width="100%">

<!-- Hier startet der REPEATER -->
<tr><td colspan="3">

<div class="mytoolbar">
    <com:TButton Text="neues Thema" OnCommand="propertyAction" CommandName="add" CssClass="windowcontent-button" />
</div>

<com:TActiveRepeater ID="edProtokollDetailGroupList" 
                     OnItemCommand="propertyAction"
                     onItemDataBound="load_prtdetails">

	<prop:EmptyTemplate>
	</prop:EmptyTemplate>
	
	<prop:HeaderTemplate>
	</prop:HeaderTemplate>
	
	<prop:FooterTemplate>
	</prop:FooterTemplate>

		<prop:ItemTemplate>
			<com:TActiveLabel ID="edidta_protokoll_detail_group" Text=<%# $this->DataItem->idta_protokoll_detail_group %> />
				<com:TActiveLabel Text=<%# ProtokollDetailRecord::finder()->findByidta_protokoll_detail_group($this->DataItem->idta_protokoll_detail_group)->prtdet_topic %> />	
			<table width="100%">
			<tr><td bgcolor="#cdcdcd">&nbsp;</td><td>
				
                            <com:TActiveRepeater ID="edProtokollDetailList" OnItemCommand="page.propertyAction" onItemDataBound="page.edbuildZielePullDown">
					
					<prop:EmptyTemplate>
                                		kein Thema existiert<br/>
					</prop:EmptyTemplate>
					
					<prop:HeaderTemplate>
                                        	<table width="100%">
					</prop:HeaderTemplate>
					
					<prop:FooterTemplate>
                                                </table>
					</prop:FooterTemplate>
					
					<prop:ItemTemplate>
                                        <tr>
                                            <td colspan="3" class="mytoolbar">
                                                
                                                Thema: <com:TTextBox ID="edprtdet_topic" Text=<%# $this->DataItem->prtdet_topic %> CssClass="inputlarge" />
                                            <com:TActiveButton
                                                Text="Save"
                                                CommandName="save"
                                                CommandParameter=<%# $this->DataItem->idtm_protokoll_detail %>
                                                 CssClass="windowcontent-button"
                                                />
                                                Protokollpunkt - Lfd.Nr:<com:TActiveLabel ID="edidtm_protokoll_detail" Text=<%# $this->DataItem->idtm_protokoll_detail %> />
                                            <com:TActiveButton
                                                Text="Remove"
                                                CommandName="remove"
                                                CommandParameter=<%# $this->DataItem->idtm_protokoll_detail %>
                                                 CssClass="windowcontent-button"
                                                />
                                            </td>
                                        </tr>					
					<tr>
					  	<td valign="top" colspan="2">
							<com:TActiveTextBox ID="edprtdet_descr" Text=<%# $this->DataItem->prtdet_descr %>  TextMode="MultiLine" Rows="7" CssClass="commentbox"/>
						</td>
						<td valign="top">
    <table width="100%" class="PSPFAZ">
       <tr>
          <td>
              Ergebnistyp: </td><td><com:TActiveDropDownList ID="edidta_protokoll_ergebnistype" Text=<%# $this->DataItem->idta_protokoll_ergebnistype %> />
          </td>
        </tr>
        <tr>
          <td valign="top">
              WVL: </td><td><com:TActiveCheckBox ID="edprtdet_wvl" Checked=<%# $this->DataItem->prtdet_wvl %> />
          </td>
       </tr>
       <tr>
          <td>
              Zielbezug: </td><td><com:TActiveDropDownList ID="edidtt_ziele" Text=<%# $this->DataItem->idtt_ziele %> />
          </td>
       </tr>
     </table>
                    </td>
                    </tr>

                    <!-- Part for the tasks -->
                    <com:TActivePanel id="supertask" Visible=<%# $this->DataItem->idta_protokoll_ergebnistype==1 OR $this->DataItem->idta_protokoll_ergebnistype==2?1:0 %>>

                    <tr><td colspan="3" class="portlet-title">Auftrag/Beschluss</td></tr>
                    <tr>
                            <td valign="top" colspan="2">
                                    <com:TActiveTextbox ID="Aedauf_beschreibung" TextMode="MultiLine" Text=<%# $this->DataItem->auf_beschreibung %> />
                            </td>
                            <td id="infoboxsmall" colspan="3">
                    Formulieren Sie hier bitte das konkrete Ergebnis (nur bei Beschluss/Auftrag)
                    </td>
                    </tr>
                    <tr>
                      <td valign="top">
                        <com:TActiveTextBox id="Aedidtm_aufgaben" Text=<%# $this->DataItem->idtm_aufgaben %> CssClass="hiddeninput" visible="false" />
                            <com:TActiveTextBox id="Aedauf_tabelle" Text="tm_protokoll_detail" CssClass="hiddeninput" visible="false" />
                            <com:TActiveTextBox id="Aedauf_id" Text=<%# $this->DataItem->idtm_protokoll_detail %> CssClass="hiddeninput" visible="false" />

                      Auftragnehmer: <com:TActiveDropDownList ID="Aedidtm_organisation" Text=<%# $this->DataItem->idtm_organisation %> />
                      </td>
                      <td>
                      Termin: <com:TActiveDatePicker Id="Aedauf_tdate" Mode="ImageButton" DateFormat="yyyy-MM-dd" InputMode="DropDownList" Text=<%# $this->DataItem->auf_tdate %> />
                      </td>
                      <td id="infoboxsmall" colspan="3">
                    Auftragnehmer und Termin
                    </td>
                    </tr>
                    <tr>
                    <td colspan="2">Erledigt: <com:TActiveCheckBox ID="Aedauf_done" Checked=<%# $this->DataItem->auf_done %> />
                      <com:TActiveDatePicker Id="Aedauf_ddate" Mode="ImageButton" DateFormat="yyyy-MM-dd" InputMode="DropDownList" Text=<%# $this->DataItem->auf_ddate %> /></td>
                    <td id="infoboxsmall">Erledigt? Wann?</td>
                    </tr>
                    </com:TActivePanel>
                    <!-- Part for the tasks -->
            </table>
		</prop:ItemTemplate>
            </com:TActiveRepeater>
	</prop:ItemTemplate>
</com:TActiveRepeater>

			
	<p class="mytoolbar">
		<com:TButton Text="neues Thema" OnCommand="propertyAction" CommandName="add" CssClass="windowcontent-button" />
	</p>

</td></tr>
<!-- Hier endet der REPEATER -->


</table>

</div></div>

</com:TContent>